<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org" translate="no">
<head>
<title>Mass And Balance - ADMIN</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- BULMA -->
<link rel="stylesheet" th:href="@{/lib/bulma.css}">

<!-- FONT AWESOME -->
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.css" />

<!-- JQUERY -->
<script th:src="@{/lib/jquery-3.6.0.min.js}"></script>

<!-- HTML TO PDF -->
<script th:src="@{https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js}"></script>

<!-- SCRIPT -->
<script th:src="@{/js/mab.js}"></script>

<style type="text/css">
@media print
{    
  .no-print, .no-print *
  {
    display: none !important;
  }
}
@page  
{ 
  size: auto;   /* auto is the initial value */ 
  margin: 0mm 0mm 0mm 0mm;  
}

</style>

</head>
<body th:with="act = ${aircraft}">

	<section class="hero is-small is-primary no-print">
		<div class="hero-body">
			<p class="title is-clickable"
				onclick="window.location.href = window.location.origin+'/home'">Mass and
				balance</p>
			<p class="subtitle">by Colin LEFEBVRE - cle@colef.fr</p>
		</div>
	</section>

	<section class="section p-5" id="main_section">
		<div class="container is-fullhd box">
			
			<p class="title has-text-centered mt-3 mb-5">
				DEVIS MASSE ET CENTRAGE
				<a class="button no-print ml-6 is-primary is-outlined" id="print_btn" title="Print">
					<i class="fas fa-print"></i>
				</a>
				<a class="button no-print is-primary is-outlined" id="pdf_btn" title="Exporter en pdf">
					<i class="fas fa-file-pdf"></i>
				</a>
			</p>
			
			<div class="columns is-vcentered">
				<div class="column has-text-centered">
					<img th:if="${act.imageUrl}" th:src="${act.imageUrl}"
										alt="image" width="200px">
					<div th:unless="${act.imageUrl}" width="200px"></div>			
				</div>
				<div class="column ">
						<p class="title is-1 my-5 has-text-centered" th:text="${act.registrationMark}"/>
				</div>
			</div>
			
			<div class="is-flex is-flex-wrap-wrap is-justify-content-space-between" style="row-gap: 2rem;">
			
				<div class="table-container">
					<p class="subtitle mb-2 has-text-centered">
						<span class="mr-6">TABLEAU DE CENTRAGE</span>
						
						<span class="is-size-7 ml-6"> 
								Densité de carburant utilisée : 
								<input class="input is-small p-0 fuel-d mab-field is-primary" 
													type="number" th:value="${act.defaultFuelDensity}" 
													id="fuel_density" style="width: 3rem;">
								kg/l					
						</span>
					</p>
					
					<table class="table is-striped is-narrow" style="margin: auto;">
						<thead class="has-text-centered">
							<tr>
								<th style="width: 0px;min-width: 5rem;" rowspan="2"></th>
								<th style="width: 0px;min-width: 5rem;" rowspan="2">Levier</th>
								<th style="width: 0px;min-width: 5rem;" rowspan="2">Moment</th>
								<th style="width: 0px;min-width: 5rem;" rowspan="2">Masse Max</th>
								<th style="width: 0px;min-width: 5rem;" rowspan="2">Masse kg</th>
								<th style="width: 0px;min-width: 5rem;" colspan="2">Carburant</th>
								
							</tr>
							<tr>
								<th style="width: 0px;min-width: 5rem;">Litres</th>
								<th style="width: 0px;min-width: 5rem;">USG</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="ws : ${act.weightStations}" class="input-row" th:classappend="${ws.isFuel} ? 'is-fuel'">
								<td th:text="${ws.name}"/>
								<td th:text="${ws.arm}" class="mab-arm"/>
								<td class="mab-moment has-text-grey-light"/>
								<td th:text="${ws.maxWeight}" class="mab-max-weight"/>
								<td>
									<input type="number" class="input is-small mab-weight mab-field" 
											th:readOnly="! ${ws.isEditable}" th:value="${ws.defaultWeight}"
											th:classappend="|${ws.isFuel != null && ws.isFuel ? 'fuel-kg':''} 
																			${ws.isEditable != null && ws.isEditable ? 'is-primary':''}|">
								</td>
								<td>
									<input th:if="${ws.isFuel}" type="number" class="input is-small fuel-l mab-field is-primary">
								</td>
								<td>
									<input th:if="${ws.isFuel}" type="number" class="input is-small fuel-usg mab-field is-primary">
								</td>
								
							</tr>
						</tbody>
						<tfoot>
							<tr class="result-row has-background-primary-light" >
								<td class="has-text-weight-bold">RESULT</td>
								<td class="has-text-weight-bold mab-arm"/>
								<td class="mab-moment has-text-grey-light"/>
								<td th:text="${act.maximumTakeOffWeight}"/>
								<td class="has-text-weight-bold mab-weight"/>
								<td></td>
								<td></td>
							</tr>
						</tfoot>
					</table>
				</div>
			
				<div class="table-container">
					<p class="subtitle mb-2 has-text-centered">DIAGRAMME</p>
					
					<div class="has-text-centered p-4">
						<div th:each="line : ${act.massAndBalanceLines}" class="is-hidden mab-line">
							<input type="hidden" class="p1-arm" th:value="${line.p1Arm}">
							<input type="hidden" class="p1-weight" th:value="${line.p1Weight}">
							<input type="hidden" class="p2-arm" th:value="${line.p2Arm}">
							<input type="hidden" class="p2-weight" th:value="${line.p2Weight}">
						</div>
						
						<input id="mtow" type="hidden" th:value="${act.maximumTakeOffWeight}">
						<input id="mlw" type="hidden"  th:value="${act.maximumLandingWeight}">
						<input id="mzfw" type="hidden" th:value="${act.maximumZeroFuelWeight}">
						<input id="fuel_flow" type="hidden" th:value="${act.fuelFlow}">
						
						
						<canvas id="mab_canvas" style="border: solid 2px lightgray ;width: 350px;height: 200px;"></canvas>
					</div>
					
				</div>
			
				<div class="table-container">
					<p class="subtitle mb-2 has-text-centered">LIMITATIONS</p>
					
					<table class="table is-narrow is-size-7 mb-4" style="margin: auto;">
						<tr>
							<td class="px-1"  style="vertical-align: middle;">
								Temps de vol estimé :
							</td>
							<td class="px-1"  style="vertical-align: middle;">
									<input id="flight_time" class="input is-small py-0 is-primary mab-field" type="number" value="60"  style="width: 4rem;height: 1.5rem;">
							</td>
							<td class="px-1"  style="vertical-align: middle;">
								min
							</td>
						</tr>
						<tr>
							<td class="px-1" style="vertical-align: middle;">
								Consommation horaire :
							</td>
							<td class="px-1" th:text="${act.fuelFlow} ? ${act.fuelFlow} + ' lph' : ''" style="vertical-align: middle;"/>
							<td class="px-1" th:text="${act.fuelFlow} ? '( ' + ${#numbers.formatDecimal(act.fuelFlow / 3.78541, 0, 1)} +' gph )' :'' "  
										style="vertical-align: middle;white-space: nowrap;"/>
						</tr>
						
					</table>
					
					<table class="table is-narrow" style="margin: auto;white-space: nowrap;" id="limit_table">
						<thead>
							<tr>
								<th></th>
								<th>Valeur</th>
								<th>Limite</th>
							</tr>
						</thead>
						<tbody>
						</tbody>
					</table>
					
				</div>
			
			</div>

		</div>
	</section>

</body>
</html>